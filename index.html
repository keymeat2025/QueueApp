
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QueueApp - Complete System</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50">
    <div id="app"></div>
    <script>
        const DB = {
            restaurants: JSON.parse(localStorage.getItem('restaurants') || '{}'),
            
            save() { 
                console.log('üíæ Saving to localStorage');
                localStorage.setItem('restaurants', JSON.stringify(this.restaurants)); 
            },
            
            addRestaurant(id, data) { 
                this.restaurants[id] = { 
                    ...data, 
                    queue: [], 
                    tables: [], 
                    createdAt: Date.now(), 
                    plan: 'free'
                }; 
                console.log(`‚úÖ Restaurant ${id} created with FREE plan`);
                this.save(); 
                return id; 
            },
            
            addToQueue(restaurantId, customer) { 
                const restaurant = this.restaurants[restaurantId]; 
                if (!restaurant) {
                    console.error(`‚ùå Restaurant ${restaurantId} not found`);
                    return null;
                }
                
                const originalPlan = restaurant.plan;
                const queueNumber = `A-${Math.floor(Math.random() * 900) + 100}`; 
                
                restaurant.queue.push({ 
                    ...customer, 
                    queueNumber, 
                    status: 'waiting', 
                    joinedAt: Date.now() 
                }); 
                
                restaurant.plan = originalPlan || 'free';
                
                console.log(`‚úÖ Customer added. Plan: ${restaurant.plan}`);
                this.save(); 
                return queueNumber; 
            },
            
            allocateTable(restaurantId, queueNumber, tableNo) { 
                const restaurant = this.restaurants[restaurantId]; 
                if (!restaurant) return false;
                
                const queueItem = restaurant.queue.find(q => q.queueNumber === queueNumber); 
                if (queueItem) { 
                    queueItem.status = 'allocated'; 
                    queueItem.tableNo = tableNo; 
                    queueItem.allocatedAt = Date.now();
                    this.save(); 
                    return true; 
                } 
                return false; 
            },
            
            login(restaurantId, phone) { 
                const restaurant = this.restaurants[restaurantId]; 
                return restaurant && restaurant.phone === phone; 
            },
            
            upgradePlan(restaurantId, plan) { 
                const restaurant = this.restaurants[restaurantId]; 
                if (restaurant) { 
                    restaurant.plan = plan; 
                    console.log(`‚úÖ Plan changed to: ${plan} for ${restaurantId}`);
                    this.save(); 
                    return true; 
                } 
                return false; 
            }
        };
        
        function getLoggedInRestaurant() {
            const allRestaurants = Object.keys(DB.restaurants);
            for (let id of allRestaurants) {
                if (sessionStorage.getItem(`loggedIn_${id}`)) {
                    return { id, data: DB.restaurants[id] };
                }
            }
            return null;
        }
        
        function navigateHome() {
            const loggedIn = getLoggedInRestaurant();
            if (loggedIn) {
                console.log(`üè† Logo clicked: User logged in ‚Üí Dashboard`);
                navigate(`/r/${loggedIn.id}/admin`);
            } else {
                console.log(`üè† Logo clicked: User not logged in ‚Üí Home`);
                navigate('/');
            }
        }
        
        function render(html) { document.getElementById('app').innerHTML = html; }
        function navigate(path) { window.location.hash = path; }
        function handleRoute() {
            const hash = window.location.hash.slice(1) || '/';
            const parts = hash.split('/').filter(Boolean);
            if (hash === '/' || hash === '') showHome();
            else if (hash === '/pricing') showPricing();
            else if (hash === '/terms') showTerms();
            else if (hash === '/privacy') showPrivacy();
            else if (hash === '/signup') showSignup();
            else if (hash === '/login') showLogin();
            else if (hash === '/admin') {
                if (sessionStorage.getItem('adminAuth') === 'yes') {
                    showPlatformAdmin();
                } else {
                    showAdminPasswordPrompt();
                }
            }
            else if (parts[0] === 'r' && parts[2] === 'join') showJoinQueue(parts[1]);
            else if (parts[0] === 'r' && parts[2] === 'display') showDisplay(parts[1]);
            else if (parts[0] === 'r' && parts[2] === 'status' && parts[3]) showQueueStatus(parts[1], parts[3]);
            else if (parts[0] === 'r' && parts[2] === 'admin') { 
                const loggedIn = sessionStorage.getItem(`loggedIn_${parts[1]}`); 
                if (loggedIn) {
                    const restaurant = DB.restaurants[parts[1]];
                    console.log(`üîç Loading admin for ${parts[1]}, Plan: ${restaurant?.plan}`);
                    showRestaurantAdmin(parts[1]); 
                } else {
                    showRestaurantLogin(parts[1]); 
                }
            }
            else render(`<div class="p-8 text-center"><h1 class="text-4xl">404 - Page Not Found</h1><button onclick="navigate('/')" class="mt-4 bg-blue-600 text-white px-6 py-3 rounded-lg">Go Home</button></div>`);
        }
        window.onhashchange = handleRoute;
        
        function showHome() {
            render(`<div class="min-h-screen bg-gradient-to-br from-orange-50 to-pink-50"><nav class="bg-white shadow-md p-4"><div class="container mx-auto flex justify-between items-center"><h1 class="text-2xl font-bold text-orange-600 cursor-pointer" onclick="navigateHome()">QueueApp</h1><div class="space-x-4"><button onclick="navigate('/pricing')" class="text-gray-700 hover:text-orange-600 font-semibold">Pricing</button><button onclick="navigate('/login')" class="text-gray-700 hover:text-orange-600 font-semibold">Login</button><button onclick="navigate('/signup')" class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700">Sign Up</button></div></div></nav><main class="container mx-auto px-4 py-16 text-center"><h1 class="text-6xl font-bold text-gray-900 mb-6">Smart Queue Management</h1><p class="text-2xl text-gray-600 mb-12">No more crowded entrances. Happy customers.</p><div class="grid md:grid-cols-3 gap-8 max-w-5xl mx-auto mb-12"><div class="bg-white p-8 rounded-2xl shadow-lg"><div class="text-4xl mb-4">üì±</div><h3 class="text-xl font-bold mb-2">Digital Queue</h3><p class="text-gray-600">Customers join via QR code</p></div><div class="bg-white p-8 rounded-2xl shadow-lg"><div class="text-4xl mb-4">üì∫</div><h3 class="text-xl font-bold mb-2">Live Display</h3><p class="text-gray-600">Real-time queue on TV</p></div><div class="bg-white p-8 rounded-2xl shadow-lg"><div class="text-4xl mb-4">üí¨</div><h3 class="text-xl font-bold mb-2">WhatsApp Updates</h3><p class="text-gray-600">Auto notifications</p></div></div><button onclick="navigate('/signup')" class="bg-gradient-to-r from-orange-500 to-pink-600 text-white px-12 py-4 rounded-xl text-xl font-bold hover:shadow-xl">Start Free Forever</button><p class="mt-4 text-gray-600">No credit card required ‚Ä¢ 500 customers/month free</p></main><footer class="bg-white border-t border-gray-200 py-8 mt-16"><div class="container mx-auto px-4 text-center"><div class="flex justify-center gap-8 mb-4"><button onclick="navigate('/terms')" class="text-gray-600 hover:text-orange-600">Terms of Service</button><button onclick="navigate('/privacy')" class="text-gray-600 hover:text-orange-600">Privacy Policy</button><a href="mailto:support@queueapp.com" class="text-gray-600 hover:text-orange-600">Contact Support</a></div><p class="text-gray-500 text-sm">¬© 2024 QueueApp. All rights reserved.</p></div></footer></div>`);
        }

        function showTerms() {
            render(`<div class="min-h-screen bg-gray-50"><nav class="bg-white shadow-md p-4"><div class="container mx-auto flex justify-between items-center"><h1 class="text-2xl font-bold text-orange-600 cursor-pointer" onclick="navigateHome()">QueueApp</h1><button onclick="navigateHome()" class="text-gray-700 hover:text-orange-600">‚Üê Back to Home</button></div></nav><div class="container mx-auto px-4 py-12 max-w-4xl"><h1 class="text-4xl font-bold text-gray-900 mb-4">Terms of Service</h1><p class="text-gray-600 mb-8">Last Updated: November 23, 2024</p><div class="bg-white rounded-xl shadow-lg p-8 space-y-6 max-h-[600px] overflow-y-auto">
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">1. Acceptance of Terms</h2><p class="text-gray-700">By accessing or using QueueApp ("the Service"), you agree to be bound by these Terms of Service. If you do not agree to these terms, please do not use the Service.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">2. Service Description</h2><p class="text-gray-700 mb-3">QueueApp provides a digital queue management system for restaurants and businesses. The Service includes:</p><ul class="list-disc list-inside text-gray-700 space-y-2 ml-4"><li>Digital queue management</li><li>Customer entry via QR codes</li><li>Live display screens</li><li>Table allocation systems</li><li>Customer notifications (WhatsApp/SMS)</li><li>Analytics and reporting</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">3. Account Registration</h2><p class="text-gray-700 mb-2">To use the Service, you must:</p><ul class="list-disc list-inside text-gray-700 space-y-2 ml-4"><li>Provide accurate and complete registration information</li><li>Maintain the security of your account credentials</li><li>Be at least 18 years old or have parental consent</li><li>Notify us immediately of any unauthorized access</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">4. Subscription Plans</h2><p class="text-gray-700 mb-3"><strong>Free Plan:</strong></p><ul class="list-disc list-inside text-gray-700 space-y-1 ml-4 mb-3"><li>Up to 500 customers per month</li><li>1 location</li><li>Basic features</li><li>Free forever, no credit card required</li></ul><p class="text-gray-700 mb-3"><strong>Premium Plan (‚Çπ2,999/month per location):</strong></p><ul class="list-disc list-inside text-gray-700 space-y-1 ml-4"><li>Unlimited customers</li><li>WhatsApp notifications</li><li>Advanced analytics</li><li>Custom branding</li><li>Priority support</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">5. Payment Terms</h2><ul class="list-disc list-inside text-gray-700 space-y-2 ml-4"><li>Premium subscriptions are billed monthly in advance</li><li>All fees are in Indian Rupees (‚Çπ) and non-refundable</li><li>You can cancel your subscription at any time</li><li>Upon cancellation, you'll be downgraded to the Free plan</li><li>We reserve the right to change pricing with 30 days notice</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">6. User Responsibilities</h2><ul class="list-disc list-inside text-gray-700 space-y-2 ml-4"><li>You are responsible for all activity under your account</li><li>You must not use the Service for any illegal purposes</li><li>You must not attempt to breach security or system integrity</li><li>You must comply with all applicable laws and regulations</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">7. Data Usage</h2><p class="text-gray-700">You retain ownership of all customer data you collect through the Service. QueueApp acts as a data processor and will not use your data for any purpose other than providing the Service.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">8. Service Availability</h2><p class="text-gray-700">We strive for 99.9% uptime but cannot guarantee uninterrupted service. We are not liable for any downtime or service interruptions.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">9. Limitation of Liability</h2><p class="text-gray-700">QueueApp shall not be liable for any indirect, incidental, special, consequential, or punitive damages resulting from your use of the Service.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">10. Termination</h2><p class="text-gray-700">We reserve the right to suspend or terminate your account if you violate these Terms or engage in fraudulent activity.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">11. Modifications to Terms</h2><p class="text-gray-700">We may update these Terms from time to time. Continued use of the Service after changes constitutes acceptance of the new Terms.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">12. Governing Law</h2><p class="text-gray-700">These Terms are governed by the laws of India. Any disputes shall be resolved in the courts of Bangalore, India.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">13. Intellectual Property</h2><p class="text-gray-700">All content, trademarks, and intellectual property rights in the Service belong to QueueApp. You may not use our branding without permission.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">14. Third-Party Services</h2><p class="text-gray-700">The Service may integrate with third-party services (WhatsApp, SMS providers, payment gateways). Your use of these services is subject to their respective terms.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">15. Warranty Disclaimer</h2><p class="text-gray-700">The Service is provided "as is" without warranties of any kind, either express or implied.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">16. Contact Information</h2><p class="text-gray-700">For questions about these Terms, contact us at:<br>Email: legal@queueapp.com<br>Support: support@queueapp.com</p></section>
            
            </div><div class="mt-8 text-center"><button onclick="navigateHome()" class="bg-orange-600 text-white px-8 py-3 rounded-xl hover:bg-orange-700">Back to Home</button></div></div></div>`);
        }

        function showPrivacy() {
            render(`<div class="min-h-screen bg-gray-50"><nav class="bg-white shadow-md p-4"><div class="container mx-auto flex justify-between items-center"><h1 class="text-2xl font-bold text-orange-600 cursor-pointer" onclick="navigateHome()">QueueApp</h1><button onclick="navigateHome()" class="text-gray-700 hover:text-orange-600">‚Üê Back to Home</button></div></nav><div class="container mx-auto px-4 py-12 max-w-4xl"><h1 class="text-4xl font-bold text-gray-900 mb-4">Privacy Policy</h1><p class="text-gray-600 mb-8">Last Updated: November 23, 2024</p><div class="bg-white rounded-xl shadow-lg p-8 space-y-6 max-h-[600px] overflow-y-auto">
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">1. Introduction</h2><p class="text-gray-700">QueueApp ("we," "us," or "our") is committed to protecting your privacy. This Privacy Policy explains how we collect, use, disclose, and safeguard your information when you use our queue management service.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">2. Information We Collect</h2><p class="text-gray-700 mb-3"><strong>a) Restaurant/Business Information:</strong></p><ul class="list-disc list-inside text-gray-700 space-y-1 ml-4 mb-3"><li>Restaurant name, owner name, email, phone, location</li><li>Billing and payment information</li><li>Account credentials</li></ul><p class="text-gray-700 mb-3"><strong>b) Customer Information:</strong></p><ul class="list-disc list-inside text-gray-700 space-y-1 ml-4 mb-3"><li>Name, phone number</li><li>Queue status and wait times</li><li>Number of guests</li></ul><p class="text-gray-700 mb-3"><strong>c) Technical Information:</strong></p><ul class="list-disc list-inside text-gray-700 space-y-1 ml-4"><li>Browser type and version</li><li>Device information</li><li>IP address</li><li>Usage data and analytics</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">3. How We Use Your Information</h2><ul class="list-disc list-inside text-gray-700 space-y-2 ml-4"><li>Provide and maintain the queue management service</li><li>Send customer notifications via WhatsApp/SMS</li><li>Generate analytics and reports</li><li>Process payments for Premium subscriptions</li><li>Improve user experience and service quality</li><li>Communicate with you about service updates</li><li>Comply with legal obligations</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">4. Data Storage</h2><p class="text-gray-700 mb-2"><strong>Free Plan:</strong> Data stored in browser localStorage (temporary)</p><p class="text-gray-700"><strong>Premium Plan:</strong> Secure server-side storage with encrypted backups</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">5. Data Sharing</h2><p class="text-gray-700 mb-3">We do not sell your personal data. We may share data with:</p><ul class="list-disc list-inside text-gray-700 space-y-2 ml-4"><li><strong>Service Providers:</strong> WhatsApp API, SMS gateways, payment processors (Razorpay/Stripe)</li><li><strong>Legal Requirements:</strong> When required by law or to protect our rights</li><li><strong>Business Transfers:</strong> In case of merger, acquisition, or sale</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">6. Customer Data Ownership</h2><p class="text-gray-700">Restaurants retain full ownership of their customer data. QueueApp acts as a data processor and will not use customer data for any purpose other than providing the Service.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">7. Data Retention</h2><ul class="list-disc list-inside text-gray-700 space-y-2 ml-4"><li>Queue data: Retained for 90 days</li><li>Account data: Retained until account deletion</li><li>Deleted accounts: Data removed within 30 days</li><li>Backups: Retained for 90 days, then permanently deleted</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">8. Your Privacy Rights</h2><p class="text-gray-700 mb-3">You have the right to:</p><ul class="list-disc list-inside text-gray-700 space-y-2 ml-4"><li><strong>Access:</strong> Request a copy of your data</li><li><strong>Correction:</strong> Update inaccurate information</li><li><strong>Deletion:</strong> Request account and data deletion</li><li><strong>Export:</strong> Download your data in portable format</li><li><strong>Opt-out:</strong> Unsubscribe from marketing communications</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">9. Cookies and Tracking</h2><p class="text-gray-700">We use essential cookies for authentication and session management. We do not use third-party advertising cookies.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">10. Security Measures</h2><ul class="list-disc list-inside text-gray-700 space-y-2 ml-4"><li>HTTPS encryption for all data transmission</li><li>Encrypted database storage</li><li>Regular security audits</li><li>Access controls and authentication</li><li>Secure payment processing via PCI-compliant providers</li></ul></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">11. Children's Privacy</h2><p class="text-gray-700">Our Service is not intended for users under 18. We do not knowingly collect data from children.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">12. Third-Party Services</h2><p class="text-gray-700">Our Service integrates with WhatsApp, SMS providers, and payment gateways. These services have their own privacy policies.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">13. International Data Transfers</h2><p class="text-gray-700">Your data is primarily stored in India. International transfers comply with applicable data protection laws.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">14. Changes to Privacy Policy</h2><p class="text-gray-700">We may update this Privacy Policy. Continued use after changes constitutes acceptance.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">15. Compliance</h2><p class="text-gray-700">We comply with the Information Technology Act, 2000 (India) and follow GDPR-aligned privacy principles.</p></section>
            
            <section><h2 class="text-2xl font-bold text-gray-900 mb-3">16. Contact Us</h2><p class="text-gray-700">For privacy concerns or data requests:<br>Email: privacy@queueapp.com<br>Support: support@queueapp.com<br>Data Protection Officer: dpo@queueapp.com</p></section>
            
            </div><div class="mt-8 text-center"><button onclick="navigateHome()" class="bg-orange-600 text-white px-8 py-3 rounded-xl hover:bg-orange-700">Back to Home</button></div></div></div>`);
        }

        function showPricing() {
            const loggedIn = getLoggedInRestaurant();
            const isLoggedIn = !!loggedIn;
            const restaurant = loggedIn?.data;
            const restaurantId = loggedIn?.id;
            const currentPlan = restaurant?.plan || 'free';
            
            if (isLoggedIn) {
                console.log(`üîç Pricing page - Restaurant: ${restaurantId}, Plan: ${currentPlan}`);
            }
            
            const navButtons = isLoggedIn 
                ? `<div class="flex items-center gap-4">
                     <span class="text-sm font-semibold text-gray-700">${restaurant.name}</span>
                     <span class="px-3 py-1 rounded-full text-xs font-bold ${currentPlan === 'premium' ? 'bg-orange-500 text-white' : 'bg-gray-400 text-white'}">${currentPlan.toUpperCase()}</span>
                     <button onclick="navigate('/r/${restaurantId}/admin')" class="text-gray-700 hover:text-orange-600 font-semibold">Dashboard</button>
                     <button onclick="logout('${restaurantId}')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">Logout</button>
                   </div>`
                : `<div class="space-x-4">
                     <button onclick="navigate('/login')" class="text-gray-700 hover:text-orange-600 font-semibold">Login</button>
                     <button onclick="navigate('/signup')" class="bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700">Sign Up</button>
                   </div>`;
            
            const freeCTA = isLoggedIn && currentPlan === 'free'
                ? `<button class="w-full bg-green-500 text-white py-4 rounded-xl font-bold text-lg cursor-not-allowed" disabled>‚úì Current Plan</button>`
                : isLoggedIn && currentPlan === 'premium'
                ? `<button onclick="confirmDowngrade('${restaurantId}')" class="w-full bg-gray-600 hover:bg-gray-700 text-white py-4 rounded-xl font-bold text-lg transition-colors">Downgrade to Free</button>`
                : `<button onclick="navigate('/signup')" class="w-full bg-gray-600 hover:bg-gray-700 text-white py-4 rounded-xl font-bold text-lg transition-colors">Start Free</button>`;
            
            const premiumCTA = isLoggedIn && currentPlan === 'premium'
                ? `<button class="w-full bg-green-500 text-white py-4 rounded-xl font-bold text-lg cursor-not-allowed" disabled>‚úì Current Plan</button>`
                : isLoggedIn && currentPlan === 'free'
                ? `<button onclick="handleUpgrade('${restaurantId}')" class="w-full bg-white hover:bg-gray-100 text-orange-600 py-4 rounded-xl font-bold text-lg transition-colors shadow-lg">Upgrade Now</button>`
                : `<button onclick="navigate('/signup')" class="w-full bg-white hover:bg-gray-100 text-orange-600 py-4 rounded-xl font-bold text-lg transition-colors shadow-lg">Get Started</button>`;

            render(`<div class="min-h-screen bg-gradient-to-br from-orange-50 to-pink-50"><nav class="bg-white shadow-md p-4"><div class="container mx-auto flex justify-between items-center"><h1 class="text-2xl font-bold text-orange-600 cursor-pointer" onclick="navigateHome()">QueueApp</h1>${navButtons}</div></nav><div class="container mx-auto px-4 py-16"><div class="text-center mb-16"><h1 class="text-5xl font-bold text-gray-900 mb-4">Simple, Honest Pricing</h1><p class="text-2xl text-gray-600 mb-6">Start free forever. Upgrade when you need more.</p>${isLoggedIn ? `<div class="inline-flex items-center gap-2 bg-blue-100 text-blue-800 px-6 py-3 rounded-full font-semibold mb-4"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"/></svg>Logged in as ${restaurant.name}</div>` : ''}<div class="inline-flex items-center gap-2 bg-green-100 text-green-800 px-6 py-3 rounded-full font-semibold"><svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg>No Credit Card ‚Ä¢ No Setup Fees ‚Ä¢ Cancel Anytime</div></div><div class="grid md:grid-cols-2 gap-8 max-w-5xl mx-auto mb-16"><div class="bg-white rounded-3xl shadow-xl p-8 border-2 ${currentPlan === 'free' && isLoggedIn ? 'border-green-500 relative' : 'border-gray-200'} hover:shadow-2xl transition-all">${currentPlan === 'free' && isLoggedIn ? '<div class="absolute -top-3 left-1/2 transform -translate-x-1/2"><span class="bg-green-500 text-white px-4 py-1 rounded-full text-sm font-bold">YOUR PLAN</span></div>' : ''}<div class="text-center mb-6"><div class="inline-block bg-green-100 text-green-700 px-4 py-1 rounded-full text-sm font-semibold mb-3">FREE FOREVER</div><h3 class="text-3xl font-bold text-gray-900 mb-2">Free</h3><p class="text-gray-600 mb-4">Perfect for getting started</p><div class="mb-6"><span class="text-6xl font-bold text-gray-900">‚Çπ0</span><span class="text-gray-600">/month</span></div></div><div class="mb-8"><p class="text-center text-sm font-semibold text-gray-700 mb-4">Up to 500 customers/month</p></div><ul class="space-y-4 mb-8"><li class="flex items-start gap-3"><svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-gray-700">1 location</span></li><li class="flex items-start gap-3"><svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-gray-700">Digital queue management</span></li><li class="flex items-start gap-3"><svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-gray-700">QR code entry</span></li><li class="flex items-start gap-3"><svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-gray-700">Live display screen</span></li><li class="flex items-start gap-3"><svg class="w-6 h-6 text-green-500 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-gray-700">Basic analytics</span></li></ul>${freeCTA}<p class="text-center text-sm text-gray-500 mt-4">Perfect for small cafes ‚Ä¢ ~17 customers/day</p></div><div class="bg-gradient-to-br from-orange-500 to-pink-600 rounded-3xl shadow-2xl p-8 transform md:scale-105 relative">${currentPlan === 'premium' && isLoggedIn ? '<div class="absolute -top-3 left-1/2 transform -translate-x-1/2"><span class="bg-green-500 text-white px-4 py-1 rounded-full text-sm font-bold">YOUR PLAN</span></div>' : '<div class="absolute -top-4 left-1/2 transform -translate-x-1/2"><span class="bg-yellow-400 text-yellow-900 px-6 py-2 rounded-full font-bold text-sm shadow-lg">‚≠ê MOST POPULAR</span></div>'}<div class="text-center mb-6"><div class="inline-block bg-white/20 backdrop-blur-sm text-white px-4 py-1 rounded-full text-sm font-semibold mb-3">ALL FEATURES</div><h3 class="text-3xl font-bold text-white mb-2">Premium</h3><p class="text-orange-100 mb-4">For serious restaurants</p><div class="mb-6"><span class="text-6xl font-bold text-white">‚Çπ2,999</span><span class="text-orange-100">/month</span></div></div><div class="mb-8"><p class="text-center text-sm font-semibold text-white mb-4">Unlimited customers ‚Ä¢ Per location</p></div><ul class="space-y-4 mb-8"><li class="flex items-start gap-3"><svg class="w-6 h-6 text-yellow-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-white font-semibold">Everything in Free, PLUS:</span></li><li class="flex items-start gap-3"><svg class="w-6 h-6 text-yellow-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-white"><strong>Unlimited customers</strong></span></li><li class="flex items-start gap-3"><svg class="w-6 h-6 text-yellow-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-white">WhatsApp notifications</span></li><li class="flex items-start gap-3"><svg class="w-6 h-6 text-yellow-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-white">Advanced analytics</span></li><li class="flex items-start gap-3"><svg class="w-6 h-6 text-yellow-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-white">Custom branding</span></li><li class="flex items-start gap-3"><svg class="w-6 h-6 text-yellow-300 flex-shrink-0 mt-0.5" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/></svg><span class="text-white">Priority support</span></li></ul>${premiumCTA}<p class="text-center text-sm text-orange-100 mt-4">Instant activation ‚Ä¢ Cancel anytime</p></div></div><div class="max-w-3xl mx-auto mb-16"><h2 class="text-3xl font-bold text-center text-gray-900 mb-8">Frequently Asked Questions</h2><div class="space-y-4"><details class="bg-white rounded-xl p-6 shadow-md"><summary class="font-bold text-gray-900 cursor-pointer">Is the free plan really free forever?</summary><p class="mt-4 text-gray-600">Yes! The free plan is 100% free forever. No credit card required. Use it as long as you want with up to 500 customers per month.</p></details><details class="bg-white rounded-xl p-6 shadow-md"><summary class="font-bold text-gray-900 cursor-pointer">What happens if I exceed 500 customers on free?</summary><p class="mt-4 text-gray-600">You'll get a notification at 450 customers. After 500, new customers can't join until next month or you upgrade to Premium for unlimited access.</p></details><details class="bg-white rounded-xl p-6 shadow-md"><summary class="font-bold text-gray-900 cursor-pointer">Can I upgrade or downgrade anytime?</summary><p class="mt-4 text-gray-600">Absolutely! Upgrade to Premium instantly or downgrade back to Free anytime. No contracts, no penalties.</p></details><details class="bg-white rounded-xl p-6 shadow-md"><summary class="font-bold text-gray-900 cursor-pointer">How does billing work for multiple locations?</summary><p class="mt-4 text-gray-600">Each location costs ‚Çπ2,999/month on Premium. So 3 locations = ‚Çπ8,997/month. Each location can be upgraded independently.</p></details></div></div><div class="bg-gradient-to-r from-orange-600 to-pink-600 rounded-3xl p-12 text-center text-white shadow-2xl"><h2 class="text-4xl font-bold mb-4">Ready to Get Started?</h2><p class="text-xl mb-8">Join restaurants already using QueueApp</p><button onclick="navigate('/signup')" class="bg-white text-orange-600 px-12 py-4 rounded-xl font-bold text-lg hover:bg-gray-100 transition-colors shadow-lg">Start Free Forever</button><p class="mt-4 text-sm text-orange-100">No credit card ‚Ä¢ Upgrade anytime</p></div></div><footer class="bg-white border-t border-gray-200 py-8 mt-16"><div class="container mx-auto px-4 text-center"><div class="flex justify-center gap-8 mb-4"><button onclick="navigate('/terms')" class="text-gray-600 hover:text-orange-600">Terms of Service</button><button onclick="navigate('/privacy')" class="text-gray-600 hover:text-orange-600">Privacy Policy</button><a href="mailto:support@queueapp.com" class="text-gray-600 hover:text-orange-600">Contact Support</a></div><p class="text-gray-500 text-sm">¬© 2024 QueueApp. All rights reserved.</p></div></footer></div>`);
        }
        
        function handleUpgrade(restaurantId) {
            alert('Payment integration coming soon!\n\nContact: sales@queueapp.com');
            DB.upgradePlan(restaurantId, 'premium');
            navigate('/pricing');
        }
        
        function confirmDowngrade(restaurantId) {
            if (confirm('Are you sure you want to downgrade to Free plan?\n\nYou will lose Premium features.')) {
                DB.upgradePlan(restaurantId, 'free');
                alert('‚úÖ Downgraded to Free plan successfully!');
                navigate('/pricing');
            }
        }
        
        function showAdminPasswordPrompt() {
            render(`<div class="min-h-screen bg-gradient-to-br from-gray-900 to-gray-800 p-6 flex items-center justify-center"><div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full"><h1 class="text-3xl font-bold text-gray-900 mb-6 text-center">üîê Platform Admin</h1><div class="space-y-4"><input type="password" id="adminPass" placeholder="Enter Master Password" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><button onclick="checkAdminPassword()" class="w-full bg-gray-900 text-white py-4 rounded-xl font-bold text-lg">Login</button></div></div></div>`);
        }
        
        function checkAdminPassword() {
            const pass = document.getElementById('adminPass').value;
            if (pass === 'SuperAdmin2024!@#') {
                sessionStorage.setItem('adminAuth', 'yes');
                navigate('/admin');
            } else {
                alert('‚ùå Wrong password');
            }
        }
        
        function showLogin() {
            render(`<div class="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 p-6 flex items-center justify-center"><div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full"><h1 class="text-3xl font-bold text-gray-900 mb-6 text-center">Restaurant Login</h1><div class="space-y-4"><input type="text" id="loginRestaurantId" placeholder="Restaurant ID" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><input type="tel" id="loginPhone" placeholder="Phone Number" maxlength="10" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><button onclick="handleLogin()" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 rounded-xl font-bold text-lg">Login</button><p class="text-center text-gray-600 text-sm">Don't have an account? <button onclick="navigate('/signup')" class="text-blue-600 font-semibold">Sign Up</button></p></div></div></div>`);
        }
        
        function handleLogin() {
            const restaurantId = document.getElementById('loginRestaurantId').value.trim();
            const phone = document.getElementById('loginPhone').value.trim();
            if (!restaurantId || !phone) { alert('Please enter Restaurant ID and Phone'); return; }
            if (DB.login(restaurantId, phone)) { 
                sessionStorage.setItem(`loggedIn_${restaurantId}`, 'true'); 
                alert('‚úÖ Login successful!'); 
                navigate(`/r/${restaurantId}/admin`); 
            } else { 
                alert('‚ùå Invalid Restaurant ID or Phone Number'); 
            }
        }
        
        function showRestaurantLogin(restaurantId) {
            render(`<div class="min-h-screen bg-gradient-to-br from-blue-500 to-purple-600 p-6 flex items-center justify-center"><div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full"><h1 class="text-3xl font-bold text-gray-900 mb-6 text-center">Login Required</h1><p class="text-gray-600 text-center mb-6">Please login to access admin panel</p><div class="space-y-4"><input type="tel" id="restaurantLoginPhone" placeholder="Phone Number" maxlength="10" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><button onclick="handleRestaurantLogin('${restaurantId}')" class="w-full bg-gradient-to-r from-blue-500 to-purple-600 text-white py-4 rounded-xl font-bold text-lg">Login</button></div></div></div>`);
        }
        
        function handleRestaurantLogin(restaurantId) {
            const phone = document.getElementById('restaurantLoginPhone').value.trim();
            if (!phone) { alert('Please enter phone number'); return; }
            if (DB.login(restaurantId, phone)) { 
                sessionStorage.setItem(`loggedIn_${restaurantId}`, 'true'); 
                handleRoute(); 
            } else { 
                alert('‚ùå Invalid phone number'); 
            }
        }
        
        function showSignup() {
            render(`<div class="min-h-screen bg-gradient-to-br from-orange-500 to-pink-600 p-6 flex items-center justify-center"><div class="bg-white rounded-3xl shadow-2xl p-8 max-w-2xl w-full"><h1 class="text-3xl font-bold text-gray-900 mb-6 text-center">Register Your Restaurant</h1><div class="space-y-4"><input type="text" id="restaurantName" placeholder="Restaurant Name" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><input type="text" id="ownerName" placeholder="Owner Name" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><input type="email" id="email" placeholder="Email" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><input type="tel" id="phone" placeholder="Phone (10 digits)" maxlength="10" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><input type="text" id="city" placeholder="City" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><div class="flex items-start gap-3"><input type="checkbox" id="agreeTerms" class="mt-1"><label for="agreeTerms" class="text-sm text-gray-600">I agree to the <button onclick="navigate('/terms')" class="text-orange-600 font-semibold">Terms of Service</button> and <button onclick="navigate('/privacy')" class="text-orange-600 font-semibold">Privacy Policy</button></label></div><button onclick="handleSignup()" class="w-full bg-gradient-to-r from-orange-500 to-pink-600 text-white py-4 rounded-xl font-bold text-lg">Register</button><p class="text-center text-gray-600 text-sm">Already registered? <button onclick="navigate('/login')" class="text-orange-600 font-semibold">Login</button></p></div></div></div>`);
        }
        
        function handleSignup() {
            const name = document.getElementById('restaurantName').value;
            const owner = document.getElementById('ownerName').value;
            const email = document.getElementById('email').value;
            const phone = document.getElementById('phone').value;
            const city = document.getElementById('city').value;
            const agreeTerms = document.getElementById('agreeTerms').checked;
            if (!name || !owner || !email || !phone || !city) { alert('Please fill all fields'); return; }
            if (!agreeTerms) { alert('‚ö†Ô∏è Please agree to Terms of Service and Privacy Policy'); return; }
            const restaurantId = name.substring(0, 3).toUpperCase().replace(/[^A-Z]/g, 'X') + Math.floor(Math.random() * 1000);
            DB.addRestaurant(restaurantId, { name, owner, email, phone, city });
            sessionStorage.setItem(`loggedIn_${restaurantId}`, 'true');
            alert(`‚úÖ Success! Your Restaurant ID: ${restaurantId}\n\nüì± Customer Entry: #/r/${restaurantId}/join\nüì∫ Display Screen: #/r/${restaurantId}/display\n‚öôÔ∏è Admin Panel: #/r/${restaurantId}/admin\n\nüîë Login with ID: ${restaurantId} and Phone: ${phone}\n\nüéâ You're on the FREE plan (500 customers/month)`);
            navigate(`/r/${restaurantId}/admin`);
        }
        
        function showJoinQueue(restaurantId) {
            const restaurant = DB.restaurants[restaurantId];
            if (!restaurant) { 
                render(`<div class="p-8 text-center"><h1 class="text-2xl text-red-600">Restaurant not found</h1><button onclick="navigate('/')" class="mt-4 bg-blue-600 text-white px-6 py-3 rounded-lg">Go Home</button></div>`); 
                return; 
            }
            render(`<div class="min-h-screen bg-gradient-to-br from-orange-500 to-pink-600 p-6 flex items-center justify-center"><div class="bg-white rounded-3xl shadow-2xl p-8 max-w-md w-full"><h1 class="text-3xl font-bold text-gray-900 mb-2 text-center">Join Queue</h1><p class="text-gray-600 text-center mb-6">${restaurant.name}</p><div class="space-y-6"><input type="text" id="customerName" placeholder="Your Name" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><input type="tel" id="customerPhone" placeholder="Mobile (10 digits)" maxlength="10" class="w-full px-4 py-3 border-2 rounded-xl outline-none"><div><label class="block text-sm font-semibold mb-2">Number of Guests</label><div class="grid grid-cols-4 gap-2">${[1,2,3,4,5,6,7,8].map(n => `<button onclick="selectGuests(${n})" id="guest-${n}" class="py-3 rounded-xl font-semibold ${n === 2 ? 'bg-orange-500 text-white' : 'bg-gray-100'}">${n}</button>`).join('')}</div></div><button onclick="handleJoinQueue('${restaurantId}')" class="w-full bg-gradient-to-r from-orange-500 to-pink-600 text-white py-4 rounded-xl font-bold text-lg">Join Queue</button></div></div></div>`);
            window.selectedGuests = 2;
        }
        
        function selectGuests(n) {
            window.selectedGuests = n;
            document.querySelectorAll('[id^="guest-"]').forEach(btn => { 
                btn.className = 'py-3 rounded-xl font-semibold bg-gray-100'; 
            });
            document.getElementById(`guest-${n}`).className = 'py-3 rounded-xl font-semibold bg-orange-500 text-white';
        }
        
        function handleJoinQueue(restaurantId) {
            const name = document.getElementById('customerName').value;
            const phone = document.getElementById('customerPhone').value;
            const guests = window.selectedGuests || 2;
            
            if (!name || !phone) { 
                alert('Please fill all fields'); 
                return; 
            }
            
            const queueNumber = DB.addToQueue(restaurantId, { name, phone, guests });
            const restaurant = DB.restaurants[restaurantId];
            const position = restaurant.queue.filter(q => q.status === 'waiting').length;
            const estimatedWait = position * 5;
            
            // Show enhanced confirmation page
            render(`
                <div class="min-h-screen bg-gradient-to-br from-green-500 to-emerald-600 p-6 flex items-center justify-center">
                    <div class="bg-white rounded-3xl shadow-2xl p-12 max-w-2xl w-full text-center">
                        
                        <div class="text-8xl mb-6 animate-bounce">‚úÖ</div>
                        
                        <h1 class="text-4xl font-bold text-gray-900 mb-4">You're in Queue!</h1>
                        <p class="text-2xl text-gray-600 mb-8">${restaurant.name}</p>
                        
                        <div class="bg-gradient-to-r from-orange-500 to-pink-600 rounded-2xl p-8 mb-8">
                            <p class="text-white text-2xl mb-2">Your Queue Number</p>
                            <div class="text-white text-9xl font-bold">${queueNumber}</div>
                        </div>
                        
                        <div class="grid grid-cols-2 gap-6 mb-8">
                            <div class="bg-blue-50 rounded-2xl p-6">
                                <div class="text-5xl font-bold text-blue-600">#${position}</div>
                                <div class="text-gray-600 mt-2">Position</div>
                            </div>
                            <div class="bg-purple-50 rounded-2xl p-6">
                                <div class="text-5xl font-bold text-purple-600">~${estimatedWait} min</div>
                                <div class="text-gray-600 mt-2">Est. Wait</div>
                            </div>
                        </div>
                        
                        <div class="bg-yellow-50 border-4 border-yellow-400 rounded-2xl p-6 mb-8">
                            <div class="text-4xl mb-3">üëÄ</div>
                            <h2 class="text-2xl font-bold text-gray-900 mb-3">WATCH THE DISPLAY SCREEN</h2>
                            <p class="text-xl text-gray-700 mb-4">Your number will appear on the screen when your table is ready</p>
                            <div class="flex items-center justify-center gap-3 text-lg text-gray-600">
                                <span>üîî</span>
                                <span>We'll call <strong>${queueNumber}</strong> when it's your turn</span>
                            </div>
                        </div>
                        
                        <div class="space-y-4">
                            <button onclick="navigate('/r/${restaurantId}/display')" 
                                    class="w-full bg-gradient-to-r from-blue-600 to-purple-600 text-white py-6 rounded-xl text-2xl font-bold hover:shadow-xl transition-all">
                                üì∫ View Live Display
                            </button>
                            <button onclick="navigate('/r/${restaurantId}/status/${queueNumber}')" 
                                    class="w-full bg-gray-200 text-gray-700 py-4 rounded-xl text-xl font-semibold hover:bg-gray-300 transition-all">
                                üì± Check My Status
                            </button>
                        </div>
                        
                        <div class="mt-8 text-gray-500 text-sm">
                            <p>${name} ‚Ä¢ ${phone} ‚Ä¢ ${guests} guests</p>
                        </div>
                        
                    </div>
                </div>
            `);
        }
        
        // NEW: Queue Status Page
        function showQueueStatus(restaurantId, queueNumber) {
            const restaurant = DB.restaurants[restaurantId];
            if (!restaurant) {
                render(`<div class="p-8 text-center"><h1 class="text-2xl text-red-600">Restaurant not found</h1></div>`);
                return;
            }
            
            const myQueue = restaurant.queue.find(q => q.queueNumber === queueNumber);
            
            if (!myQueue) {
                render(`
                    <div class="min-h-screen bg-gradient-to-br from-red-500 to-pink-600 p-6 flex items-center justify-center">
                        <div class="bg-white rounded-3xl shadow-2xl p-12 max-w-2xl w-full text-center">
                            <div class="text-8xl mb-6">‚ùå</div>
                            <h1 class="text-4xl font-bold text-gray-900 mb-4">Queue Number Not Found</h1>
                            <p class="text-xl text-gray-600 mb-8">We couldn't find queue number ${queueNumber}</p>
                            <button onclick="navigate('/r/${restaurantId}/join')" 
                                    class="bg-orange-600 text-white px-8 py-4 rounded-xl text-xl font-bold">
                                Join Queue
                            </button>
                        </div>
                    </div>
                `);
                return;
            }
            
            if (myQueue.status === 'allocated') {
                render(`
                    <div class="min-h-screen bg-gradient-to-br from-green-500 to-emerald-600 p-6 flex items-center justify-center">
                        <div class="bg-white rounded-3xl shadow-2xl p-12 max-w-2xl w-full text-center">
                            <div class="text-8xl mb-6 animate-bounce">üéâ</div>
                            <h1 class="text-5xl font-bold text-gray-900 mb-4">Your Table is Ready!</h1>
                            
                            <div class="bg-gradient-to-r from-green-500 to-emerald-600 rounded-2xl p-8 mb-8">
                                <p class="text-white text-2xl mb-2">Go to Table</p>
                                <div class="text-white text-9xl font-bold">${myQueue.tableNo}</div>
                            </div>
                            
                            <p class="text-2xl text-gray-600 mb-4">Queue Number: ${queueNumber}</p>
                            <p class="text-xl text-gray-500 mb-8">Please proceed to your table</p>
                            
                            <div class="space-y-3">
                                <button onclick="navigate('/r/${restaurantId}/display')" 
                                        class="w-full bg-blue-600 text-white px-8 py-4 rounded-xl text-xl font-bold">
                                    üì∫ View Display Screen
                                </button>
                                <button onclick="navigate('/r/${restaurantId}/join')" 
                                        class="w-full bg-gray-200 text-gray-700 px-8 py-4 rounded-xl text-xl font-semibold">
                                    Join New Queue
                                </button>
                            </div>
                        </div>
                    </div>
                `);
            } else {
                const waiting = restaurant.queue.filter(q => q.status === 'waiting');
                const position = waiting.findIndex(q => q.queueNumber === queueNumber) + 1;
                const estimatedWait = position * 5;
                
                render(`
                    <div class="min-h-screen bg-gradient-to-br from-orange-500 to-pink-600 p-6 flex items-center justify-center">
                        <div class="bg-white rounded-3xl shadow-2xl p-12 max-w-2xl w-full text-center">
                            <div class="text-6xl mb-6">‚è≥</div>
                            <h1 class="text-4xl font-bold text-gray-900 mb-4">Still in Queue</h1>
                            
                            <div class="bg-gradient-to-r from-orange-500 to-pink-600 rounded-2xl p-8 mb-8">
                                <div class="text-white text-8xl font-bold">${queueNumber}</div>
                            </div>
                            
                            <div class="grid grid-cols-2 gap-6 mb-8">
                                <div class="bg-blue-50 rounded-2xl p-6">
                                    <div class="text-5xl font-bold text-blue-600">#${position}</div>
                                    <div class="text-gray-600 mt-2">Current Position</div>
                                </div>
                                <div class="bg-purple-50 rounded-2xl p-6">
                                    <div class="text-5xl font-bold text-purple-600">~${estimatedWait} min</div>
                                    <div class="text-gray-600 mt-2">Est. Wait</div>
                                </div>
                            </div>
                            
                            <div class="bg-yellow-50 border-2 border-yellow-400 rounded-xl p-6 mb-8">
                                <p class="text-xl text-gray-700">üëÄ Keep watching the display screen</p>
                            </div>
                            
                            <div class="space-y-3">
                                <button onclick="navigate('/r/${restaurantId}/status/${queueNumber}')" 
                                        class="w-full bg-blue-600 text-white py-4 rounded-xl text-xl font-bold">
                                    üîÑ Refresh Status
                                </button>
                                <button onclick="navigate('/r/${restaurantId}/display')" 
                                        class="w-full bg-gray-200 text-gray-700 py-4 rounded-xl text-xl font-semibold">
                                    üì∫ View Display Screen
                                </button>
                            </div>
                        </div>
                    </div>
                `);
            }
        }
        
        // ENHANCED: Display Screen
        function showDisplay(restaurantId) {
            const restaurant = DB.restaurants[restaurantId];
            if (!restaurant) { 
                render(`<div class="p-8 text-center"><h1 class="text-2xl text-red-600">Restaurant not found</h1></div>`); 
                return; 
            }
            
            const waiting = restaurant.queue.filter(q => q.status === 'waiting');
            const allocated = restaurant.queue.filter(q => q.status === 'allocated');
            const justCalled = allocated.slice(-3);
            
            render(`
                <div class="min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 text-white p-8">
                    
                    <!-- Header -->
                    <div class="bg-slate-800/50 p-8 rounded-3xl mb-8 flex justify-between items-center border-4 border-orange-500/30">
                        <div>
                            <h1 class="text-6xl font-bold text-orange-400">${restaurant.name}</h1>
                            <p class="text-2xl text-slate-300 mt-2">Queue Management System</p>
                        </div>
                        <div class="text-right">
                            <div class="text-5xl font-mono text-orange-400">${new Date().toLocaleTimeString()}</div>
                            <div class="text-xl text-slate-400 mt-2">${new Date().toLocaleDateString()}</div>
                        </div>
                    </div>

                    <!-- Now Serving -->
                    <div class="mb-8">
                        <div class="bg-gradient-to-r from-green-600 to-emerald-600 p-8 rounded-3xl border-4 border-green-400 shadow-2xl">
                            <h2 class="text-4xl font-bold text-white mb-6 flex items-center gap-4">
                                <span class="text-6xl animate-pulse">üîî</span>
                                NOW SERVING
                            </h2>
                            <div class="grid grid-cols-3 gap-6">
                                ${justCalled.length > 0 ? justCalled.map(a => `
                                    <div class="bg-white/20 backdrop-blur-lg p-6 rounded-2xl border-2 border-white/30">
                                        <div class="text-7xl font-bold text-white mb-2">${a.queueNumber}</div>
                                        <div class="text-3xl font-semibold text-green-200">Table ${a.tableNo}</div>
                                        <div class="text-xl text-white/80 mt-2">${a.guests} guests</div>
                                    </div>
                                `).join('') : '<p class="text-3xl text-white/80 col-span-3">Waiting for first customer...</p>'}
                            </div>
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-8">
                        
                        <!-- Waiting Queue -->
                        <div class="bg-orange-900/40 p-8 rounded-3xl border-4 border-orange-700/50">
                            <h2 class="text-4xl font-bold text-orange-300 mb-8 flex items-center gap-4">
                                <span class="text-5xl">‚è≥</span>
                                Waiting Queue (${waiting.length})
                            </h2>
                            <div class="space-y-4 max-h-[500px] overflow-y-auto">
                                ${waiting.length > 0 ? waiting.map((w, index) => `
                                    <div class="bg-slate-800/80 p-6 rounded-2xl border-2 ${index < 3 ? 'border-orange-500 shadow-lg shadow-orange-500/50' : 'border-orange-600/30'}">
                                        <div class="flex justify-between items-center">
                                            <div>
                                                <div class="text-5xl font-bold text-orange-400">${w.queueNumber}</div>
                                                ${index < 3 ? '<div class="text-lg text-green-400 font-bold mt-1">üîú COMING UP NEXT</div>' : ''}
                                                <div class="text-xl text-slate-300 mt-2">${w.guests} guests</div>
                                            </div>
                                            <div class="text-right">
                                                <div class="text-3xl font-bold text-slate-400">#${index + 1}</div>
                                                <div class="text-sm text-slate-500">~${(index + 1) * 5} min</div>
                                            </div>
                                        </div>
                                    </div>
                                `).join('') : '<p class="text-2xl text-slate-400">No customers waiting</p>'}
                            </div>
                        </div>

                        <!-- Instructions & Stats -->
                        <div class="space-y-8">
                            
                            <!-- How to Join -->
                            <div class="bg-blue-900/40 p-8 rounded-3xl border-4 border-blue-700/50">
                                <h2 class="text-4xl font-bold text-blue-300 mb-6">üì± How to Join Queue</h2>
                                <div class="space-y-4 text-2xl text-white">
                                    <div class="flex items-center gap-4">
                                        <span class="text-4xl">1Ô∏è‚É£</span>
                                        <span>Scan QR code at entrance</span>
                                    </div>
                                    <div class="flex items-center gap-4">
                                        <span class="text-4xl">2Ô∏è‚É£</span>
                                        <span>Enter your details</span>
                                    </div>
                                    <div class="flex items-center gap-4">
                                        <span class="text-4xl">3Ô∏è‚É£</span>
                                        <span>Get queue number</span>
                                    </div>
                                    <div class="flex items-center gap-4">
                                        <span class="text-4xl">4Ô∏è‚É£</span>
                                        <span>Watch this screen!</span>
                                    </div>
                                </div>
                            </div>

                            <!-- Live Stats -->
                            <div class="bg-purple-900/40 p-8 rounded-3xl border-4 border-purple-700/50">
                                <h2 class="text-4xl font-bold text-purple-300 mb-6">üìä Live Stats</h2>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="bg-slate-800/60 p-6 rounded-2xl">
                                        <div class="text-5xl font-bold text-orange-400">${waiting.length}</div>
                                        <div class="text-xl text-slate-300 mt-2">Waiting</div>
                                    </div>
                                    <div class="bg-slate-800/60 p-6 rounded-2xl">
                                        <div class="text-5xl font-bold text-green-400">${allocated.length}</div>
                                        <div class="text-xl text-slate-300 mt-2">Seated</div>
                                    </div>
                                    <div class="bg-slate-800/60 p-6 rounded-2xl col-span-2">
                                        <div class="text-5xl font-bold text-blue-400">~${waiting.length * 5} min</div>
                                        <div class="text-xl text-slate-300 mt-2">Estimated Wait Time</div>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>

                    <!-- Footer -->
                    <div class="mt-8 text-center text-slate-400 bg-slate-800/30 p-6 rounded-2xl">
                        <p class="text-2xl">‚ö° Powered by QueueApp - Making queues better</p>
                    </div>
                    
                </div>
            `);
            
            // Auto-refresh every 3 seconds
            setTimeout(() => handleRoute(), 3000);
        }
        
        function showRestaurantAdmin(restaurantId) {
            const restaurant = DB.restaurants[restaurantId];
            if (!restaurant) { 
                render(`<div class="p-8 text-center"><h1 class="text-2xl text-red-600">Restaurant not found</h1></div>`); 
                return; 
            }
            
            const waiting = restaurant.queue.filter(q => q.status === 'waiting');
            const allocated = restaurant.queue.filter(q => q.status === 'allocated');
            const currentPlan = restaurant.plan || 'free';
            
            console.log(`üîç Restaurant Admin - ID: ${restaurantId}, Plan: ${currentPlan}`);
            
            const planBadge = currentPlan === 'premium' 
                ? '<span class="bg-orange-500 text-white px-3 py-1 rounded-full text-sm font-bold">PREMIUM</span>' 
                : '<span class="bg-gray-400 text-white px-3 py-1 rounded-full text-sm font-bold">FREE</span>';
            
            render(`<div class="min-h-screen bg-gray-100 p-6"><div class="max-w-6xl mx-auto"><div class="bg-white rounded-2xl shadow-lg p-6 mb-6 flex justify-between items-center"><div><h1 class="text-3xl font-bold cursor-pointer" onclick="navigateHome()">QueueApp</h1><p class="text-gray-600">${restaurant.name} - Admin Panel ${planBadge}</p></div><div class="flex gap-2"><button onclick="navigate('/pricing')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 font-semibold">${currentPlan === 'free' ? 'Upgrade' : 'Manage Plan'}</button><button onclick="logout('${restaurantId}')" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">Logout</button></div></div><div class="grid grid-cols-2 gap-6 mb-6"><div class="bg-orange-50 rounded-xl p-6 border-2 border-orange-200"><div class="text-4xl font-bold text-orange-600">${waiting.length}</div><div class="text-gray-600">Customers Waiting</div></div><div class="bg-green-50 rounded-xl p-6 border-2 border-green-200"><div class="text-4xl font-bold text-green-600">${allocated.length}</div><div class="text-gray-600">Tables Occupied</div></div></div><div class="bg-white rounded-2xl shadow-lg p-6 mb-6"><h2 class="text-2xl font-bold mb-4">Waiting Queue</h2><div class="space-y-3">${waiting.length > 0 ? waiting.map(w => `<div class="border-2 border-gray-200 rounded-xl p-4 flex justify-between items-center"><div><div class="text-xl font-bold">${w.queueNumber}</div><div class="text-gray-600">${w.name} ‚Ä¢ ${w.phone}</div><div class="text-sm text-gray-500">${w.guests} guests</div></div><div class="flex gap-2 items-center"><input type="number" id="table-${w.queueNumber}" placeholder="Table #" class="w-24 px-3 py-2 border-2 rounded-lg" min="1"><button onclick="allocateTable('${restaurantId}', '${w.queueNumber}')" class="bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700">Seat</button></div></div>`).join('') : '<p class="text-gray-500">No customers in queue</p>'}</div></div><div class="bg-white rounded-2xl shadow-lg p-6 mb-6"><h2 class="text-2xl font-bold mb-4">Allocated Tables</h2><div class="grid grid-cols-3 gap-4">${allocated.length > 0 ? allocated.map(a => `<div class="border-2 border-green-200 rounded-xl p-4 bg-green-50"><div class="text-2xl font-bold text-green-600">Table ${a.tableNo}</div><div class="text-gray-600">${a.queueNumber}</div><div class="text-sm text-gray-500">${a.name} ‚Ä¢ ${a.guests} guests</div></div>`).join('') : '<p class="text-gray-500 col-span-3">No tables allocated yet</p>'}</div></div><div class="flex gap-4"><button onclick="navigate('/r/${restaurantId}/display')" class="bg-blue-600 text-white px-6 py-3 rounded-xl hover:bg-blue-700">üì∫ Display Screen</button><button onclick="navigate('/r/${restaurantId}/join')" class="bg-purple-600 text-white px-6 py-3 rounded-xl hover:bg-purple-700">üì± Customer Entry</button></div></div></div>`);
        }
        
        function logout(restaurantId) {
            sessionStorage.removeItem(`loggedIn_${restaurantId}`);
            alert('‚úÖ Logged out successfully');
            navigate('/');
        }
        
        function allocateTable(restaurantId, queueNumber) {
            const tableNo = document.getElementById(`table-${queueNumber}`).value;
            if (!tableNo || tableNo < 1) { 
                alert('‚ö†Ô∏è Please enter a valid table number'); 
                return; 
            }
            DB.allocateTable(restaurantId, queueNumber, tableNo);
            alert(`‚úÖ Table ${tableNo} allocated to ${queueNumber}!\n\nüì± Customer can check status at display screen.`);
            handleRoute();
        }
        
        function showPlatformAdmin() {
            const restaurants = Object.entries(DB.restaurants);
            const totalCustomers = restaurants.reduce((sum, [_, r]) => sum + r.queue.length, 0);
            const totalRevenue = restaurants.filter(([_, r]) => r.plan === 'premium').length * 2999;
            
            render(`<div class="min-h-screen bg-gray-100 p-6"><div class="max-w-7xl mx-auto"><div class="bg-white rounded-2xl shadow-lg p-6 mb-6 flex justify-between items-center"><div><h1 class="text-3xl font-bold">üè¢ Platform Admin Dashboard</h1><p class="text-gray-600">Manage all restaurants on QueueApp</p></div><button onclick="adminLogout()" class="bg-red-600 text-white px-4 py-2 rounded-lg hover:bg-red-700">Logout</button></div><div class="grid grid-cols-3 gap-6 mb-6"><div class="bg-blue-50 rounded-xl p-6 border-2 border-blue-200"><div class="text-4xl font-bold text-blue-600">${restaurants.length}</div><div class="text-gray-600">Total Restaurants</div></div><div class="bg-green-50 rounded-xl p-6 border-2 border-green-200"><div class="text-4xl font-bold text-green-600">${totalCustomers}</div><div class="text-gray-600">Total Customers Today</div></div><div class="bg-purple-50 rounded-xl p-6 border-2 border-purple-200"><div class="text-4xl font-bold text-purple-600">‚Çπ${totalRevenue.toLocaleString()}</div><div class="text-gray-600">Monthly Revenue</div></div></div><div class="bg-white rounded-2xl shadow-lg p-6"><div class="flex justify-between items-center mb-4"><h2 class="text-2xl font-bold">All Restaurants</h2><button onclick="navigate('/signup')" class="bg-orange-600 text-white px-6 py-3 rounded-xl hover:bg-orange-700">+ Add Restaurant</button></div><div class="space-y-3">${restaurants.length > 0 ? restaurants.map(([id, r]) => `<div class="border-2 border-gray-200 rounded-xl p-4"><div class="flex justify-between items-center"><div><div class="text-xl font-bold">${r.name} ${r.plan === 'premium' ? '<span class="text-sm bg-orange-500 text-white px-2 py-1 rounded-full ml-2">PREMIUM</span>' : '<span class="text-sm bg-gray-400 text-white px-2 py-1 rounded-full ml-2">FREE</span>'}</div><div class="text-gray-600">ID: ${id} ‚Ä¢ Owner: ${r.owner} ‚Ä¢ ${r.city}</div><div class="text-sm text-gray-500">${r.queue.filter(q => q.status === 'waiting').length} waiting ‚Ä¢ ${r.queue.filter(q => q.status === 'allocated').length} seated ‚Ä¢ ${r.queue.length} total today</div></div><div class="flex gap-2"><button onclick="navigate('/r/${id}/join')" class="bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700">Join</button><button onclick="navigate('/r/${id}/display')" class="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700">Display</button></div></div></div>`).join('') : `<div class="text-center py-12"><p class="text-gray-500 text-xl mb-4">No restaurants registered yet</p><button onclick="navigate('/signup')" class="bg-orange-600 text-white px-8 py-3 rounded-xl hover:bg-orange-700">Register First Restaurant</button></div>`}</div></div></div></div>`);
        }
        
        function adminLogout() {
            sessionStorage.removeItem('adminAuth');
            alert('‚úÖ Logged out');
            navigate('/');
        }
        
        // Global function exports
        window.navigate = navigate;
        window.navigateHome = navigateHome;
        window.selectGuests = selectGuests;
        window.handleSignup = handleSignup;
        window.handleLogin = handleLogin;
        window.handleRestaurantLogin = handleRestaurantLogin;
        window.handleJoinQueue = handleJoinQueue;
        window.allocateTable = allocateTable;
        window.logout = logout;
        window.checkAdminPassword = checkAdminPassword;
        window.adminLogout = adminLogout;
        window.handleUpgrade = handleUpgrade;
        window.confirmDowngrade = confirmDowngrade;
        
        handleRoute();
    </script>
</body>
</html>
